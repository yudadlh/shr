<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#20807f" />
  <title>Generator Undangan Pernikahan â€” Yuda & Riris</title>

  <style>
    :root{
      --bg:#FCFCF9;
      --surface:#FFFFFF;
      --muted:#626C71;
      --text:#13343B;
      --primary:#21808D;
      --primary-600:#1D7480;
      --radius:0.5rem;
      --gap:0.75rem;
      --fs:1rem;
      --shadow: 0 1px 2px rgba(0,0,0,0.04);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
      padding:1rem;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.45;
      font-size:var(--fs);
    }

    .wrap{
      max-width:820px;
      margin:0 auto;
    }

    header{margin-bottom:1rem}
    h1{
      font-size:1.5rem;
      margin:0 0 .25rem 0;
      line-height:1.15;
    }
    .subtitle{color:var(--muted); margin:0 0 1rem 0; font-size:.95rem}

    form{display:grid; gap:var(--gap)}
    label{font-weight:600; font-size:.95rem; color:var(--text)}
    input[type="text"]{
      width:100%;
      padding:.6rem .75rem;
      border:1px solid rgba(0,0,0,0.06);
      border-radius:var(--radius);
      background:var(--surface);
      box-shadow:var(--shadow);
      font:inherit;
    }
    input[type="text"]:focus{
      outline:none;
      box-shadow:0 0 0 4px rgba(33,128,141,0.12);
      border-color:var(--primary);
    }

    .row{display:flex; gap:.75rem; flex-wrap:wrap}
    .btn{
      appearance:none;
      border:0;
      padding:.6rem .9rem;
      border-radius:var(--radius);
      cursor:pointer;
      font:inherit;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:.5rem;
    }
    .btn-primary{
      background:var(--primary);
      color:#fff;
      box-shadow: 0 1px 0 rgba(0,0,0,0.04);
    }
    .btn-ghost{
      background:transparent;
      border:1px solid rgba(0,0,0,0.06);
      color:var(--text);
    }
    .btn-share-wa{background:#25D366; color:#fff;}
    .btn-share-ig{background:#E4405F; color:#fff;}

    .output {
      margin-top:1rem;
      background:var(--surface);
      border-radius:var(--radius);
      padding:1rem;
      border:1px solid rgba(0,0,0,0.04);
      box-shadow:var(--shadow);
    }
    .message{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Courier New", monospace;
      font-size:.95rem;
      background:#fff;
      padding:.75rem;
      border-radius:calc(var(--radius) - 2px);
      border:1px solid rgba(0,0,0,0.04);
      white-space:pre-wrap;
      word-break:break-word;
      max-height:40vh;
      overflow:auto;
      min-height:8rem;
      margin-bottom:.75rem;
    }

    .feedback{
      display:inline-block;
      padding:.45rem .6rem;
      border-radius:calc(var(--radius)/1.5);
      font-size:.9rem;
    }
    .feedback.success{background:rgba(33,128,141,0.09); color:var(--primary); border:1px solid rgba(33,128,141,0.14)}
    .feedback.error{background:rgba(220,38,38,0.06); color:#B91C1C; border:1px solid rgba(185,28,28,0.08)}

    /* responsive */
    @media (max-width:600px){
      h1{font-size:1.25rem}
      .row{flex-direction:column}
      .message{max-height:36vh}
    }

    /* respects reduced motion */
    @media (prefers-reduced-motion:reduce){
      *{transition:none !important}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ðŸ“§ Generator Undangan â€” Yuda &amp; Riris</h1>
      <p class="subtitle">Buat &amp; bagikan undangan dengan cepat (mobile &amp; desktop)</p>
    </header>

    <main>
      <form id="invForm" autocomplete="off" novalidate>
        <div>
          <label for="nama">Nama Tamu &amp; Partner</label>
          <input id="nama" name="nama" type="text" inputmode="text" placeholder="Contoh: John Doe atau Siti &amp; Rama" aria-describedby="hint" />
          <div id="hint" style="color:var(--muted);font-size:.9rem;margin-top:.35rem">Masukkan nama tamu, mis. "Budi Santoso", "Siti &amp; Rama". Tekan Enter untuk membuat pesan.</div>
        </div>

        <div class="row" style="margin-top:.25rem">
          <button class="btn btn-primary" type="submit" aria-label="Generate pesan undangan">Generate Pesan</button>
          <button class="btn btn-ghost" type="button" id="clearBtn" aria-label="Bersihkan form">Bersihkan</button>
        </div>
      </form>

      <section id="output" class="output" hidden aria-hidden="true">
        <h2 style="margin:.25rem 0 .6rem 0;font-size:1rem">ðŸ“‹ Pesan Siap Dikirim</h2>
        <div id="message" class="message" aria-live="polite"></div>

        <div class="row">
          <button class="btn btn-ghost" id="copyBtn" type="button" aria-label="Salin pesan ke clipboard">ðŸ“‹ Copy Pesan</button>
          <button class="btn btn-share-wa" id="waBtn" type="button" aria-label="Kirim lewat WhatsApp">ðŸ’¬ Kirim ke WA</button>
          <button class="btn btn-share-ig" id="igBtn" type="button" aria-label="Salin untuk IG DM">ðŸ“¸ Copy untuk IG DM</button>
          <div id="feedback" class="feedback" role="status" aria-live="assertive" style="display:none"></div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // Keep script minimal & non-blocking (runs after parsing)
    (function () {
      const form = document.getElementById('invForm');
      const namaInput = document.getElementById('nama');
      const output = document.getElementById('output');
      const messageEl = document.getElementById('message');
      const copyBtn = document.getElementById('copyBtn');
      const waBtn = document.getElementById('waBtn');
      const igBtn = document.getElementById('igBtn');
      const clearBtn = document.getElementById('clearBtn');
      const feedbackEl = document.getElementById('feedback');

      // simple sanitize
      function sanitize(text) {
        return String(text || '').trim();
      }

      function showFeedback(msg, type='success') {
        feedbackEl.textContent = msg;
        feedbackEl.className = 'feedback ' + (type === 'error' ? 'error' : 'success');
        feedbackEl.style.display = 'inline-block';
        // hide after 3s
        setTimeout(()=> {
          feedbackEl.style.display = 'none';
        }, 3000);
      }

      function buildLink(name) {
        // create RFC-safe path: replace spaces with '-', then encode
        // keep base domain configurable if needed
        const base = 'https://meong.nl/';
        const safe = encodeURIComponent(name.replace(/\s+/g, '-').toLowerCase());
        return base + safe + '-dan-partner';
      }

      function buildMessage(name, link) {
        return [
"Assalamu'alaikum Wr. Wb",
"Bismillahirahmanirrahim.",
"",
`Yth. ${name} & Partner`,
"",
"Tanpa mengurangi rasa hormat, perkenankan kami mengundang Bapak/Ibu/Saudara/i, teman sekaligus sahabat, untuk menghadiri acara ngunduh mantu:",
"",
"Yuda & Riris",
"",
"Berikut link undangan kami untuk info lengkap dari acara bisa kunjungi :",
"",
link,
"",
"Merupakan suatu kebahagiaan bagi kami apabila Bapak/Ibu/Saudara/i berkenan untuk hadir dan memberikan doa restu.",
"",
"Mohon maaf perihal undangan hanya di bagikan melalui pesan ini. Terima kasih banyak atas perhatiannya.",
"",
"Wassalamu'alaikum Wr. Wb.",
"Terima Kasih."
        ].join('\n');
      }

      // generate
      form.addEventListener('submit', function (e) {
        e.preventDefault();
        const raw = sanitize(namaInput.value);
        if (!raw) {
          showFeedback('Silakan masukkan nama tamu terlebih dahulu', 'error');
          namaInput.focus();
          return;
        }
        const link = buildLink(raw);
        const msg = buildMessage(raw, link);
        messageEl.textContent = msg;
        output.hidden = false;
        output.setAttribute('aria-hidden', 'false');
        showFeedback('Pesan berhasil dibuat!', 'success');
      });

      // copy to clipboard (with Safari fallback)
      async function copyText(text) {
        if (!text) return showFeedback('Tidak ada pesan untuk disalin', 'error');
        // prefer navigator.clipboard
        try {
          if (navigator.clipboard && navigator.clipboard.writeText) {
            await navigator.clipboard.writeText(text);
          } else {
            // fallback using textarea + selection
            const ta = document.createElement('textarea');
            ta.value = text;
            ta.setAttribute('readonly','');
            ta.style.position = 'absolute';
            ta.style.left = '-9999px';
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
          }
          showFeedback('âœ“ Pesan sudah disalin ke clipboard', 'success');
        } catch (err) {
          showFeedback('Gagal menyalin: ' + (err && err.message ? err.message : ''), 'error');
        }
      }

      copyBtn.addEventListener('click', function () {
        copyText(messageEl.textContent);
      });

      igBtn.addEventListener('click', function () {
        copyText(messageEl.textContent);
        showFeedback('âœ“ Pesan disalin â€” buka Instagram dan paste di DM', 'success');
      });

      // WhatsApp share (web and mobile)
      waBtn.addEventListener('click', function () {
        const text = messageEl.textContent;
        if (!text) return showFeedback('Buat pesan dulu sebelum mengirim', 'error');

        // Use API endpoint; encode component
        const encoded = encodeURIComponent(text);
        // If iOS webview or Android, wa.me works; api.whatsapp.com is standard.
        const url = 'https://api.whatsapp.com/send?text=' + encoded;

        // Try window.open; Safari on iOS may block if popup is blocked â€” but this is a direct user gesture (click), so safe.
        try {
          window.open(url, '_blank', 'noopener,noreferrer');
        } catch (err) {
          // fallback to navigate
          window.location.href = url;
        }
      });

      clearBtn.addEventListener('click', function () {
        namaInput.value = '';
        messageEl.textContent = '';
        output.hidden = true;
        output.setAttribute('aria-hidden', 'true');
        namaInput.focus();
      });

      // usability: Enter in input will submit (form handles it)
      // focus input on load
      window.addEventListener('load', function () {
        namaInput.focus();
      });

      // small enhancement: trim on blur
      namaInput.addEventListener('blur', function () {
        this.value = sanitize(this.value);
      });

    })();
  </script>
</body>
</html>
